# interface file auto-generated by buildroot
# and updated by hands (copy of buildroots  output/target/etc/network/interfaces  )
# REWRITE THIS ! REWRITE THIS ! REWRITE THIS ! REWRITE THIS ! REWRITE THIS ! REWRITE THIS ! REWRITE THIS
# beta

# NOTE: in future upd source all configs in interfaces.d, using auto-generation script or something.

#source /etc/network/interfaces.d/*       (/* empthy dir not work, can cause errs)
# change this
#CIDR_PREFIX="10.0.0." - not work

#
# Base conf, dont touch next lines
#

# setup lo
auto lo
iface lo inet loopback

# setup eth0
#auto eth0
#iface eth0 inet dhcp
auto eth0
iface eth0 inet static
     address 172.16.16.1
     netmask 255.255.255.0
#
# https://www.systutorials.com/docs/linux/man/5-interfaces/#lbAL ( pattern matching interfaeces ) - not work
#  ethX - all dhcp
#auto /eth*=eth
#iface eth inet dhcp

auto wg0
#iface wg0 inet manual
iface wg0 inet manual
#       address 10.0.0.1
#       netmask 255.255.255.0
       up ip link add dev $IFACE type wireguard
       #up /usr/local/bin/myconfigscript
       up source /etc/default/systemconfig ; ip address add dev $IFACE $WG_ALLOWED_IPS_PREFIX"1/24"
       up ip link set dev $IFACE up
       #up ip address add dev wg0 172.16.16.2/24
       #down ifconfig $IFACE down
       address 10.0.0.1
       netmask 255.255.255.0
       down ip link del dev $IFACE

# setup wireguard test - static not work
#auto wg0
#iface wg0 inet static
#       requires eth0
#       use wireguard
#       address 10.0.0.1
#       netmask 255.255.255.0
#       post-up iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE;iptables -A FORWARD -o wg0 -j ACCEPT
#       post-down iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE;iptables -D FORWARD -o wg0 -j ACCEPT
#        or
#        post-up wg-quick up /etc/wireguard/wg0.conf
#        post-down wg-quick down /etc/wireguard/wg0.conf
#
